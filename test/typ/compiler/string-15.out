--- parse tree ---
[ Comment
, ParBreak
, Code
    "typ/compiler/string-15.typ"
    ( line 3 , column 2 )
    (FuncCall
       (Ident (Identifier "test"))
       [ NormalArg
           (FuncCall
              (FieldAccess
                 (Ident (Identifier "replace")) (Literal (String "abc")))
              [ NormalArg
                  (FuncCall
                     (Ident (Identifier "regex"))
                     [ NormalArg (Literal (String "[a-z]")) ])
              , NormalArg
                  (FuncExpr
                     [ NormalParam (Identifier "m") ]
                     (Block
                        (CodeBlock
                           [ Plus
                               (Plus
                                  (FuncCall
                                     (Ident (Identifier "str"))
                                     [ NormalArg
                                         (FieldAccess
                                            (Ident (Identifier "start")) (Ident (Identifier "m")))
                                     ])
                                  (FieldAccess
                                     (Ident (Identifier "text")) (Ident (Identifier "m"))))
                               (FuncCall
                                  (Ident (Identifier "str"))
                                  [ NormalArg
                                      (FieldAccess
                                         (Ident (Identifier "end")) (Ident (Identifier "m")))
                                  ])
                           ])))
              ])
       , NormalArg (Literal (String "0a11b22c3"))
       ])
, SoftBreak
, Code
    "typ/compiler/string-15.typ"
    ( line 6 , column 2 )
    (FuncCall
       (Ident (Identifier "test"))
       [ NormalArg
           (FuncCall
              (FieldAccess
                 (Ident (Identifier "replace")) (Literal (String "abcd, efgh")))
              [ NormalArg
                  (FuncCall
                     (Ident (Identifier "regex"))
                     [ NormalArg (Literal (String "\\w+")) ])
              , NormalArg
                  (FuncExpr
                     [ NormalParam (Identifier "m") ]
                     (Block
                        (CodeBlock
                           [ FuncCall
                               (Ident (Identifier "upper"))
                               [ NormalArg
                                   (FieldAccess
                                      (Ident (Identifier "text")) (Ident (Identifier "m")))
                               ]
                           ])))
              ])
       , NormalArg (Literal (String "ABCD, EFGH"))
       ])
, SoftBreak
, Code
    "typ/compiler/string-15.typ"
    ( line 9 , column 2 )
    (FuncCall
       (Ident (Identifier "test"))
       [ NormalArg
           (FuncCall
              (FieldAccess
                 (Ident (Identifier "replace")) (Literal (String "hello : world")))
              [ NormalArg
                  (FuncCall
                     (Ident (Identifier "regex"))
                     [ NormalArg (Literal (String "^(.+)\\s*(:)\\s*(.+)$")) ])
              , NormalArg
                  (FuncExpr
                     [ NormalParam (Identifier "m") ]
                     (Block
                        (CodeBlock
                           [ Plus
                               (Plus
                                  (Plus
                                     (FuncCall
                                        (Ident (Identifier "upper"))
                                        [ NormalArg
                                            (FuncCall
                                               (FieldAccess
                                                  (Ident (Identifier "at"))
                                                  (FieldAccess
                                                     (Ident (Identifier "captures"))
                                                     (Ident (Identifier "m"))))
                                               [ NormalArg (Literal (Int 0)) ])
                                        ])
                                     (FuncCall
                                        (FieldAccess
                                           (Ident (Identifier "at"))
                                           (FieldAccess
                                              (Ident (Identifier "captures"))
                                              (Ident (Identifier "m"))))
                                        [ NormalArg (Literal (Int 1)) ]))
                                  (Literal (String " ")))
                               (FuncCall
                                  (Ident (Identifier "upper"))
                                  [ NormalArg
                                      (FuncCall
                                         (FieldAccess
                                            (Ident (Identifier "at"))
                                            (FieldAccess
                                               (Ident (Identifier "captures"))
                                               (Ident (Identifier "m"))))
                                         [ NormalArg (Literal (Int 2)) ])
                                  ])
                           ])))
              ])
       , NormalArg (Literal (String "HELLO : WORLD"))
       ])
, SoftBreak
, Code
    "typ/compiler/string-15.typ"
    ( line 12 , column 2 )
    (FuncCall
       (Ident (Identifier "test"))
       [ NormalArg
           (FuncCall
              (FieldAccess
                 (Ident (Identifier "replace"))
                 (Literal (String "hello world, lorem ipsum")))
              [ NormalArg
                  (FuncCall
                     (Ident (Identifier "regex"))
                     [ NormalArg (Literal (String "(\\w+) (\\w+)")) ])
              , NormalArg
                  (FuncExpr
                     [ NormalParam (Identifier "m") ]
                     (Block
                        (CodeBlock
                           [ Plus
                               (Plus
                                  (FuncCall
                                     (FieldAccess
                                        (Ident (Identifier "at"))
                                        (FieldAccess
                                           (Ident (Identifier "captures"))
                                           (Ident (Identifier "m"))))
                                     [ NormalArg (Literal (Int 1)) ])
                                  (Literal (String " ")))
                               (FuncCall
                                  (FieldAccess
                                     (Ident (Identifier "at"))
                                     (FieldAccess
                                        (Ident (Identifier "captures")) (Ident (Identifier "m"))))
                                  [ NormalArg (Literal (Int 0)) ])
                           ])))
              ])
       , NormalArg (Literal (String "world hello, ipsum lorem"))
       ])
, SoftBreak
, Code
    "typ/compiler/string-15.typ"
    ( line 15 , column 2 )
    (FuncCall
       (Ident (Identifier "test"))
       [ NormalArg
           (FuncCall
              (FieldAccess
                 (Ident (Identifier "replace"))
                 (Literal (String "hello world, lorem ipsum")))
              [ NormalArg
                  (FuncCall
                     (Ident (Identifier "regex"))
                     [ NormalArg (Literal (String "(\\w+) (\\w+)")) ])
              , KeyValArg (Identifier "count") (Literal (Int 1))
              , NormalArg
                  (FuncExpr
                     [ NormalParam (Identifier "m") ]
                     (Block
                        (CodeBlock
                           [ Plus
                               (Plus
                                  (FuncCall
                                     (FieldAccess
                                        (Ident (Identifier "at"))
                                        (FieldAccess
                                           (Ident (Identifier "captures"))
                                           (Ident (Identifier "m"))))
                                     [ NormalArg (Literal (Int 1)) ])
                                  (Literal (String " ")))
                               (FuncCall
                                  (FieldAccess
                                     (Ident (Identifier "at"))
                                     (FieldAccess
                                        (Ident (Identifier "captures")) (Ident (Identifier "m"))))
                                  [ NormalArg (Literal (Int 0)) ])
                           ])))
              ])
       , NormalArg (Literal (String "world hello, lorem ipsum"))
       ])
, SoftBreak
, Code
    "typ/compiler/string-15.typ"
    ( line 18 , column 2 )
    (FuncCall
       (Ident (Identifier "test"))
       [ NormalArg
           (FuncCall
              (FieldAccess
                 (Ident (Identifier "replace")) (Literal (String "123 456")))
              [ NormalArg
                  (FuncCall
                     (Ident (Identifier "regex"))
                     [ NormalArg (Literal (String "[a-z]+")) ])
              , NormalArg (Literal (String "a"))
              ])
       , NormalArg (Literal (String "123 456"))
       ])
, ParBreak
, Code
    "typ/compiler/string-15.typ"
    ( line 20 , column 2 )
    (FuncCall
       (Ident (Identifier "test"))
       [ NormalArg
           (FuncCall
              (FieldAccess
                 (Ident (Identifier "replace")) (Literal (String "abc")))
              [ NormalArg (Literal (String ""))
              , NormalArg
                  (FuncExpr [ NormalParam (Identifier "m") ] (Literal (String "-")))
              ])
       , NormalArg (Literal (String "-a-b-c-"))
       ])
, SoftBreak
, Code
    "typ/compiler/string-15.typ"
    ( line 21 , column 2 )
    (FuncCall
       (Ident (Identifier "test"))
       [ NormalArg
           (FuncCall
              (FieldAccess
                 (Ident (Identifier "replace")) (Literal (String "abc")))
              [ NormalArg (Literal (String ""))
              , NormalArg
                  (FuncExpr [ NormalParam (Identifier "m") ] (Literal (String "-")))
              , KeyValArg (Identifier "count") (Literal (Int 1))
              ])
       , NormalArg (Literal (String "-abc"))
       ])
, SoftBreak
, Code
    "typ/compiler/string-15.typ"
    ( line 22 , column 2 )
    (FuncCall
       (Ident (Identifier "test"))
       [ NormalArg
           (FuncCall
              (FieldAccess
                 (Ident (Identifier "replace")) (Literal (String "123")))
              [ NormalArg (Literal (String "abc"))
              , NormalArg
                  (FuncExpr [ NormalParam (Identifier "m") ] (Literal (String "")))
              ])
       , NormalArg (Literal (String "123"))
       ])
, SoftBreak
, Code
    "typ/compiler/string-15.typ"
    ( line 23 , column 2 )
    (FuncCall
       (Ident (Identifier "test"))
       [ NormalArg
           (FuncCall
              (FieldAccess
                 (Ident (Identifier "replace")) (Literal (String "123")))
              [ NormalArg (Literal (String "abc"))
              , NormalArg
                  (FuncExpr [ NormalParam (Identifier "m") ] (Literal (String "")))
              , KeyValArg (Identifier "count") (Literal (Int 2))
              ])
       , NormalArg (Literal (String "123"))
       ])
, SoftBreak
, Code
    "typ/compiler/string-15.typ"
    ( line 24 , column 2 )
    (FuncCall
       (Ident (Identifier "test"))
       [ NormalArg
           (FuncCall
              (FieldAccess
                 (Ident (Identifier "replace")) (Literal (String "a123b123c")))
              [ NormalArg (Literal (String "123"))
              , NormalArg
                  (FuncExpr
                     [ NormalParam (Identifier "m") ]
                     (Block
                        (CodeBlock
                           [ Plus
                               (Plus
                                  (FuncCall
                                     (Ident (Identifier "str"))
                                     [ NormalArg
                                         (FieldAccess
                                            (Ident (Identifier "start")) (Ident (Identifier "m")))
                                     ])
                                  (Literal (String "-")))
                               (FuncCall
                                  (Ident (Identifier "str"))
                                  [ NormalArg
                                      (FieldAccess
                                         (Ident (Identifier "end")) (Ident (Identifier "m")))
                                  ])
                           ])))
              ])
       , NormalArg (Literal (String "a1-4b5-8c"))
       ])
, SoftBreak
, Code
    "typ/compiler/string-15.typ"
    ( line 27 , column 2 )
    (FuncCall
       (Ident (Identifier "test"))
       [ NormalArg
           (FuncCall
              (FieldAccess
                 (Ident (Identifier "replace")) (Literal (String "halla warld")))
              [ NormalArg (Literal (String "a"))
              , NormalArg
                  (FuncExpr
                     [ NormalParam (Identifier "m") ]
                     (Block
                        (CodeBlock
                           [ If
                               [ ( Equals
                                     (FieldAccess
                                        (Ident (Identifier "start")) (Ident (Identifier "m")))
                                     (Literal (Int 1))
                                 , Block (CodeBlock [ Literal (String "e") ])
                                 )
                               , ( Or
                                     (Equals
                                        (FieldAccess
                                           (Ident (Identifier "start")) (Ident (Identifier "m")))
                                        (Literal (Int 4)))
                                     (Equals
                                        (FieldAccess
                                           (Ident (Identifier "start")) (Ident (Identifier "m")))
                                        (Literal (Int 7)))
                                 , Block (CodeBlock [ Literal (String "o") ])
                                 )
                               ]
                           ])))
              ])
       , NormalArg (Literal (String "hello world"))
       ])
, SoftBreak
, Code
    "typ/compiler/string-15.typ"
    ( line 31 , column 2 )
    (FuncCall
       (Ident (Identifier "test"))
       [ NormalArg
           (FuncCall
              (FieldAccess
                 (Ident (Identifier "replace")) (Literal (String "aaa")))
              [ NormalArg (Literal (String "a"))
              , NormalArg
                  (FuncExpr
                     [ NormalParam (Identifier "m") ]
                     (FuncCall
                        (Ident (Identifier "str"))
                        [ NormalArg
                            (FuncCall
                               (FieldAccess
                                  (Ident (Identifier "len"))
                                  (FieldAccess
                                     (Ident (Identifier "captures")) (Ident (Identifier "m"))))
                               [])
                        ]))
              ])
       , NormalArg (Literal (String "000"))
       ])
, ParBreak
]
--- evaluated ---
document(body: { parbreak(), 
                 text(body: [✅]), 
                 text(body: [
]), 
                 text(body: [✅]), 
                 text(body: [
]), 
                 text(body: [✅]), 
                 text(body: [
]), 
                 text(body: [✅]), 
                 text(body: [
]), 
                 text(body: [✅]), 
                 text(body: [
]), 
                 text(body: [✅]), 
                 parbreak(), 
                 text(body: [✅]), 
                 text(body: [
]), 
                 text(body: [✅]), 
                 text(body: [
]), 
                 text(body: [✅]), 
                 text(body: [
]), 
                 text(body: [✅]), 
                 text(body: [
]), 
                 text(body: [✅]), 
                 text(body: [
]), 
                 text(body: [✅]), 
                 text(body: [
]), 
                 text(body: [✅]), 
                 parbreak() })
